# ä¸€äº›Linuxå‘½ä»¤

é¦–å…ˆä»‹ç»ä¸¤ä¸ªå®ç”¨çš„CLIå·¥å…·ï¼š
* `tldr`ä¸€ä¸ªæ¯”`man`æ›´ç®€å•æ˜“æ‡‚çš„å‘½ä»¤æ–‡æ¡£æŸ¥è¯¢å·¥å…·ï¼šhttps://github.com/tldr-pages/tldr
* `fuck`è‡ªåŠ¨çº æ­£å‘½ä»¤é”™è¯¯ï¼šhttps://github.com/nvbn/thefuck

## Just For Fun

* `neofetch`/`fastfetch`æ‰“å°ç³»ç»Ÿä¿¡æ¯
* `fortune`éšæœºè¾“å‡ºåè¨€
* `cowsay [message]`è¾“å‡ºå„ç§åŠ¨ç‰©ï¼ˆé»˜è®¤æ˜¯ç‰›ï¼‰è¯´è¯çš„asciiè¡¨æƒ…
* `fortune | cowsay`è¾“å‡ºç‰›è¯´fortuneåè¨€çš„asciiè¡¨æƒ…

## æœ€åŸºç¡€

* `sudo`è¶…çº§ç”¨æˆ·æ‰§è¡Œ
* `su`æ”¹å˜ç”¨æˆ·(switch user)ï¼Œå¦‚`su root`æ”¹å˜ç”¨æˆ·ä¸ºroot
* `ls`åˆ—è¡¨æ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹å†…å®¹
* `cd`æ”¹å˜å½“å‰ç›®å½•
* `mkdir`åˆ›å»ºæ–°ç›®å½•
* `cp`å¤åˆ¶
* `mv`ç§»åŠ¨æˆ–é‡å‘½åï¼ˆæºè·¯å¾„å’Œç›®æ ‡è·¯å¾„ç›¸åŒï¼Œä»…æ–‡ä»¶åä¸åŒï¼Œå³ä¸ºé‡å‘½åï¼‰
* `rm`åˆ é™¤

## æ—¥å¸¸ä½¿ç”¨

* `top`/`ps -aux`æŸ¥çœ‹å½“å‰ç³»ç»Ÿè¿›ç¨‹
* `htop`æŸ¥çœ‹å½“å‰ç³»ç»Ÿè¿›ç¨‹ï¼ˆæ›´é«˜çº§ï¼‰
* `netstat -a`æ˜¾ç¤ºæ‰€æœ‰ç½‘ç»œè¿æ¥
* `lsof -i:80`æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨ç«¯å£çš„è¿›ç¨‹
* `xz -d`ã€`tar -xf`ã€`tar jxvf`ä¸€äº›è§£å‹å‘½ä»¤
* `date`æ˜¾ç¤ºå½“å‰æ—¶é—´
* `cal`æ˜¾ç¤ºå½“æœˆæ—¥å†`cal [month] [year]`æ˜¾ç¤ºæŒ‡å®šå¹´æœˆæ—¥å†`cal [year]`æ˜¾ç¤ºæŒ‡å®šå¹´å…¨å¹´æ—¥å†

## ç”¨æˆ·ä¸ä¸»æœº

* `whoami`æ˜¾ç¤ºå½“å‰ç”¨æˆ·
* `who`æ˜¾ç¤ºå½“å‰ç™»å½•åˆ°è¯¥æœºå™¨çš„æ‰€æœ‰ç”¨æˆ·
* `id`æ˜¾ç¤ºå½“å‰ç”¨æˆ·id(UID)ã€ç”¨æˆ·ç»„id(GID)ç­‰ä¿¡æ¯
* `hostname`æ˜¾ç¤ºå½“å‰ä¸»æœºå
* `cwd`æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„
* `passwd`ä¿®æ”¹å¯†ç 
* `useradd -m username`åˆ›å»ºç”¨æˆ·
* `userdel -r username`åˆ é™¤ç”¨æˆ·
* `usermod -aG groupname username`æ·»åŠ ç”¨æˆ·åˆ°ç»„ï¼Œä¾‹å¦‚ï¼š`usermod -aG sudo username`æ·»åŠ åˆ°sudoç»„
* `usermod -u newUID username` `usermod -g newGID username`æ›´æ”¹ç”¨æˆ·UIDå’ŒGID
* `hostnamectl set-hostname xxx`æ›´æ”¹ä¸»æœºåï¼Œé‡å¯åç”Ÿæ•ˆï¼ˆå°†ä¼šæ›´æ”¹/etc/hostnameæ–‡ä»¶ï¼Œå¹¶å¤„ç†ä¸ä¸»æœºåç›¸å…³çš„å…¶ä»–ç³»ç»Ÿé…ç½®ï¼‰

## æ–‡ä»¶ç®¡ç†

* `mount /dev/sda1 /mnt/udisk0`ä¸´æ—¶æŒ‚è½½è®¾å¤‡ï¼ˆå¦‚Uç›˜ï¼‰ï¼Œå…³æœºåå¤±æ•ˆã€‚ä¿®æ”¹`/etc/fstab`æ–‡ä»¶ä»¥å®ç°å¼€æœºè‡ªåŠ¨æŒ‚è½½
* `udisksctl unmount -b /dev/sda1`å¸è½½æ–‡ä»¶ç³»ç»Ÿ
* `udisksctl power-off -b /dev/sda`å…³é—­è®¾å¤‡ç”µæºï¼ˆå¼¹å‡ºUç›˜ï¼‰
* `lsof /mnt/udisk0`æŸ¥çœ‹æ–‡ä»¶è¢«å“ªä¸ªè¿›ç¨‹å ç”¨
* `fdisk -l`æŸ¥çœ‹ç£ç›˜åˆ†åŒºä¿¡æ¯
* `fdisk`ä¿®æ”¹ç£ç›˜åˆ†åŒºè¡¨
* `lsblk`åˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯
* `lsblk -f`åˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯ï¼Œå¸¦ç£ç›˜uuidï¼ˆç”¨äºåœ¨`/etc/fstab`ä¸­é…ç½®ç£ç›˜æŒ‚è½½ï¼‰
* `df -h`æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ
* `chmod`ä¿®æ”¹æ–‡ä»¶æƒé™ï¼ŒæŸ¥é˜…ï¼šhttps://www.runoob.com/linux/linux-comm-chmod.html
* `chown user[:group] /path/to/file`ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…
* `chgrp group /path/to/file`ä¿®æ”¹æ–‡ä»¶æ‰€å±ç”¨æˆ·ç»„

### /etc/fstabæ–‡ä»¶

`/etc/fstab` æ–‡ä»¶ç”¨äºé…ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½çš„è®¾å¤‡ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```
<file system> <mount point> <type> <options> <dump> <pass>
UUID=xxx-xx... /mnt/pool0 ext4 defaults 0 2
```

ç£ç›˜è®¾å¤‡UUIDå»ºè®®é€šè¿‡ `lsblk -f` å‘½ä»¤æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ `blkid` å‘½ä»¤æŸ¥çœ‹

å…¶ä¸­ï¼š
* `options` å‚æ•°å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œç”¨é€—å·åˆ†éš”ï¼Œ`defaults`è¡¨ç¤ºä»¥é»˜è®¤å‚æ•°`rw, suid, dev, exec, auto, nouser, async`æŒ‚è½½ã€‚åé¢çš„å‚æ•°ä¼šè¦†ç›–å‰é¢çš„defaultså‚æ•°ï¼Œä¾‹å¦‚ï¼Œ`defaults,ro`è¡¨ç¤ºæŒ‚è½½çš„è¯¥ç£ç›˜åªè¯»
* `dump` å­—æ®µè¡¨ç¤ºæ˜¯å¦éœ€è¦è¢«dumpå‘½ä»¤å¤‡ä»½ï¼Œ `0` è¡¨ç¤ºä¸éœ€è¦ï¼Œ `1` è¡¨ç¤ºéœ€è¦ï¼Œé€šå¸¸æ ¹æ–‡ä»¶ç³»ç»Ÿ `/` è®¾ä¸º1ï¼Œå…¶ä½™ä¸º0
* `pass` å­—æ®µè¡¨ç¤ºæ˜¯å¦éœ€è¦åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¢«fsckå‘½ä»¤æ£€æŸ¥ï¼Œ`0`è¡¨ç¤ºä¸æ£€æŸ¥ï¼Œ`1`è¡¨ç¤ºæœ€å…ˆæ£€æŸ¥ï¼Œ`2`è¡¨ç¤ºåœ¨è®¾ä¸º1çš„ç£ç›˜ä¹‹åæ£€æŸ¥ï¼Œé€šå¸¸æ ¹æ–‡ä»¶ç³»ç»Ÿ `/` è®¾ä¸º1ï¼Œå…¶ä½™ä¸º2æˆ–0

ä¸€èˆ¬ç£ç›˜è®¾ä¸º `defaults 0 2` å³å¯

## systemctl

* `status`æŸ¥çœ‹çŠ¶æ€
* `list-units`æŸ¥çœ‹æ‰€æœ‰æœåŠ¡ | æ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹ï¼š`systemctl list-units --type=target --all | grep suspend`
* `enable`å¼€æœºè‡ªå¯
* `disable`ç¦æ­¢å¼€æœºè‡ªå¯
* `start`å¯åŠ¨
* `stop`åœæ­¢
* `restart`é‡å¯
* `reload`é‡æ–°åŠ è½½
* `mask`å±è”½æœåŠ¡ï¼Œå±è”½åæ— æ³•å¯åŠ¨
* `unmask`å–æ¶ˆå±è”½

### å¯åŠ¨çº§åˆ«

| Runlevel | systemd Target         | åŠŸèƒ½è¯´æ˜                                               |
|----------|------------------------|-------------------------------------------------------|
| 0        | poweroff.target        | ğŸ”´ å…³æœºï¼ˆç³»ç»Ÿ haltï¼‰                                   |
| 1        | rescue.target          | ğŸ”§ å•ç”¨æˆ·æ¨¡å¼ï¼ˆSingle User Modeï¼‰ï¼Œä»… root ç™»å½•ï¼Œç”¨äºç»´æŠ¤|
| 2        | multi-user.target      | ğŸ‘¤ å¤šç”¨æˆ·æ¨¡å¼ï¼Œæ— ç½‘ç»œæœåŠ¡ï¼Œæ— å›¾å½¢ç•Œé¢ï¼ˆéƒ¨åˆ†ç³»ç»Ÿä¸ºé»˜è®¤æ¨¡å¼ï¼‰|
| 3        | multi-user.target      | ğŸŒ å¤šç”¨æˆ·æ¨¡å¼ï¼Œæœ‰ç½‘ç»œæœåŠ¡ï¼Œæ— å›¾å½¢ç•Œé¢ï¼Œå¸¸ç”¨äºæœåŠ¡å™¨       |
| 4        | multi-user.target      | âš™ï¸ ç”¨æˆ·è‡ªå®šä¹‰ï¼ˆå¤§å¤šæ•°ç³»ç»Ÿé»˜è®¤ä¸ runlevel 3 ç›¸åŒï¼‰        |
| 5        | graphical.target       | ğŸ–¥ï¸ å›¾å½¢ç•Œé¢æ¨¡å¼ï¼ˆå«ç™»å½•ç®¡ç†å™¨ï¼Œå¦‚ GNOME/KDEï¼‰            |
| 6        | reboot.target          | ğŸ” é‡å¯ï¼ˆç³»ç»Ÿ rebootï¼‰                                 |

æ³¨æ„ï¼šsystemdå°†runlevel 2ã€3ã€4éƒ½è§†ä¸ºç›¸åŒçš„multi-user.target

* `systemctl get-default`æŸ¥çœ‹å½“å‰é»˜è®¤å¯åŠ¨çº§åˆ«
* `sudo systemctl set-default multi-user.target`è®¾ç½®é»˜è®¤å¯åŠ¨çº§åˆ«
* `sudo systemctl isolate multi-user.target`åˆ‡æ¢åˆ°æŒ‡å®šå¯åŠ¨çº§åˆ«

## è½¯ä»¶ç®¡ç†

### åŒ…ç®¡ç†å™¨

ï¼ˆæ ¹æ®ä¸åŒçš„åŒ…ç®¡ç†å™¨é€‰æ‹©ï¼‰  
æœç´¢è½¯ä»¶ï¼ˆæ ¹æ®å¤§æ¦‚çš„åå­—ï¼Œä»è½¯ä»¶æºä¸­æŸ¥è¯¢æŸä¸ªè½¯ä»¶åŒ…çš„ç¡®åˆ‡åå­—ï¼‰ï¼š `apt search` ã€ `yum search` ã€ `dpkg -l | grep` ç­‰  
å®‰è£…è½¯ä»¶ï¼š `apt install` ã€ `yum install` ã€ `dpkg -i` ç­‰  
å¸è½½è½¯ä»¶ï¼š `apt remove` ã€ `yum remove` ã€ `dpkg -r` ç­‰  
å‡çº§è½¯ä»¶ï¼š `apt upgrade` ã€ `yum upgrade` ç­‰  
æ›´æ–°è½¯ä»¶æºï¼š `apt update` ã€ `yum update` ç­‰

#### aptæºé…ç½®

é…ç½®æ–‡ä»¶åœ¨ `/etc/apt/sources.list`

ï¼ˆå„ç§å‘è¡Œç‰ˆéƒ½å¯é€‰ï¼‰
* ä¸­ç§‘å¤§æºï¼šhttps://mirrors.ustc.edu.cn/help/ubuntu.html
* æ¸…åæºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/
* é˜¿é‡Œæºï¼šhttps://developer.aliyun.com/mirror/
* ç½‘æ˜“æºï¼šhttps://mirrors.163.com/.help/ubuntu.html

æ›´æ–°aptæºåï¼Œè¿è¡Œï¼š `sudo apt update`

### åˆ‡æ¢åŒä¸€è½¯ä»¶çš„å¤šä¸ªå®‰è£…ç‰ˆæœ¬

* `update-alternatives --list java`æŸ¥çœ‹æŸä¸ªå·¥å…·çš„å¤šä¸ªå¯æ›¿æ¢å®‰è£…ç‰ˆæœ¬
* `update-alternatives --config java`åˆ—å‡ºæ‰€æœ‰å¯æ›¿æ¢ç‰ˆæœ¬å¹¶è®©ç”¨æˆ·é€‰æ‹©ç‰ˆæœ¬è¿›è¡Œåˆ‡æ¢
* `update-alternatives --display java`åˆ—å‡ºæ‰€æœ‰ç¬¦å·é“¾æ¥ï¼ˆå¤ªè¯¦ç»†ï¼Œå»ºè®®ç›´æ¥ç”¨--listï¼‰
* `update-alternatives --auto java`å°†ç‰ˆæœ¬é€‰æ‹©è®¾ç½®ä¸ºè‡ªåŠ¨æ¨¡å¼
* `update-alternatives --set editor /usr/bin/vim.basic`è¿›å…¥æ‰‹åŠ¨æ¨¡å¼ï¼Œå¹¶æŒ‡å®šé»˜è®¤è¿è¡Œè¯¥ç‰ˆæœ¬

æŸä¸€ä¸ªå®‰è£…ç‰ˆæœ¬åæ ‡æ˜çš„â€œè‡ªåŠ¨æ¨¡å¼â€æ„å‘³ç€ï¼šå¦‚æœå½“å‰æ˜¯è‡ªåŠ¨æ¨¡å¼(Status: auto)ï¼Œåˆ™ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©å®‰è£…ç‰ˆæœ¬è¿è¡Œï¼Œè€Œè¯¥ç‰ˆæœ¬å°†ä¼šæ˜¯ç³»ç»Ÿé€‰æ‹©çš„ç‰ˆæœ¬  
å¦‚æœå½“å‰æ˜¯æ‰‹åŠ¨æ¨¡å¼(Status: manual)ï¼Œåˆ™æ ‡æ˜çš„â€œè‡ªåŠ¨æ¨¡å¼â€æ²¡æœ‰æ„ä¹‰

#### æ‰‹åŠ¨æ·»åŠ /åˆ é™¤ä¸€ä¸ªç‰ˆæœ¬

 `update-alternatives --install <ä¸»é“¾æ¥è·¯å¾„> <åå­—> <å€™é€‰ç¨‹åºè·¯å¾„> <ä¼˜å…ˆçº§>`

`update-alternatives --remove <åå­—> <å€™é€‰ç¨‹åºè·¯å¾„>` ï¼ˆåªæ˜¯ä»alternativesç®¡ç†ä¸­åˆ é™¤ï¼Œä¸ä¼šåˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶ï¼‰

* ä¸»é“¾æ¥è·¯å¾„ï¼šä¸€èˆ¬æ˜¯/usr/bin/javaï¼Œæ˜¯ç”¨æˆ·å®é™…ä½¿ç”¨çš„å‘½ä»¤è·¯å¾„ï¼ˆå‘½ä»¤ä¼šå»/usr/binä¸‹å¯»æ‰¾javaï¼‰
* åå­—ï¼šè¿™æ˜¯alternativesç®¡ç†å™¨å†…éƒ¨ä½¿ç”¨çš„åå­—ï¼ˆä¾‹å¦‚javaï¼‰
* å€™é€‰ç¨‹åºè·¯å¾„ï¼šä½ è¦æ·»åŠ çš„å®é™…ç¨‹åºè·¯å¾„ï¼Œå¯æ‰§è¡Œçš„æ–‡ä»¶å·²å®‰è£…åœ¨æ­¤å¤„
* ä¼˜å…ˆçº§ï¼šå†³å®šè‡ªåŠ¨æ¨¡å¼ä¸‹çš„é€‰æ‹©ï¼Œæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜

ä¾‹å¦‚ï¼š

```bash
sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/java-21-openjdk-amd64/bin/java 100
```

æ„æ€æ˜¯ï¼šæŠŠ/usr/lib/jvm/java-21-openjdk-amd64/bin/javaæ·»åŠ ä¸ºjavaçš„ä¸€ä¸ªå€™é€‰å®ç°ï¼Œå¹¶å»ºç«‹ä¸/usr/bin/javaçš„ç®¡ç†é“¾æ¥ã€‚å¦‚æœåœ¨è‡ªåŠ¨æ¨¡å¼ä¸‹ï¼Œä¼˜å…ˆçº§ä¸º100

è¿è¡Œåï¼Œç³»ç»Ÿä¼šåˆ›å»ºç¬¦å·é“¾æ¥ï¼š
* /etc/alternatives/java -> /usr/lib/jvm/java-21-openjdk-amd64/bin/java
* /usr/bin/java -> /etc/alternatives/java

## Makefileç¼–è¯‘

* `make -j(æ ¸å¿ƒæ•°)`æ ¹æ®Makefileç¼–è¯‘é¡¹ç›®ï¼Œå¯ä»¥æŒ‡å®šä½¿ç”¨çš„æ ¸å¿ƒæ•°é‡ã€‚è¿è¡Œmakeæ—¶ï¼Œå¦‚æœæŠ¥é”™å½¢å¦‚bison: not foundï¼Œé‚£å°±sudo apt install bisonï¼Œè°not foundå°±è£…è°ï¼›å¦‚æœæ˜¯fatal error: libelf.h: No such file or directoryè¿™ç§ï¼Œè£…libelf-devï¼Œè½¯ä»¶åŒ…è·Ÿä¸ª-devçš„æ˜¯å¯¹åº”çš„å¼€å‘åŒ…ï¼Œå¼€å‘åŒ…å°±æ˜¯å¸¦å¤´æ–‡ä»¶å’Œé™æ€åº“çš„

## è™šæ‹Ÿæœº

VMware linuxè™šæ‹ŸæœºæŒ‚è½½å…±äº«æ–‡ä»¶å¤¹:
 `sudo vmhgfs-fuse .host:/ /mnt/hgfs -o allow_other`

ä¹Ÿå¯ä»¥ç”¨rootç”¨æˆ·åªæ‰§è¡Œ `vmhgfs-fuse .host:/ /mnt/hgfs` ï¼Œæ²¡æœ‰allow_otherçš„è¯æ™®é€šç”¨æˆ·å°±è®¿é—®ä¸äº†
